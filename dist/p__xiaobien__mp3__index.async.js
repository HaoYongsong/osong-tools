"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[857],{96799:function(Fn,Z,n){n.r(Z),n.d(Z,{default:function(){return gn}});var G=n(9783),A=n.n(G),K=n(15009),x=n.n(K),J=n(19632),Q=n.n(J),X=n(99289),Y=n.n(X),b=n(5574),p=n.n(b),$=n(97857),i=n.n($),k=n(90930),w=n(84921),q=n(47581),T=n(75605),_=n(32273),nn=n(67586),tn=n(74330),U=n(25278),D=n(78957),C=n(90926),en=n(24435),an=n(95658),rn=n(96750),ln=n.n(rn),d=n(67294),sn=n(59651),on=n(43628),un=n(98502),F="https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd",dn={waveColor:"#4F4A85",progressColor:"#383351",minPxPerSec:50},vn={height:20,timeInterval:.1,primaryLabelInterval:1,style:{fontSize:"10px",color:"#6A3274"}},fn={lineColor:"#ff0000",lineWidth:2,labelBackground:"#555",labelColor:"#fff",labelSize:"11px"};function W(c){var f,a=new Date(c*1e3),y=a.getUTCHours(),j=a.getUTCMinutes(),g=a.getUTCSeconds(),m=((f=String(c).split(".")[1])===null||f===void 0?void 0:f.padEnd(3,"0").slice(0,3))||"000";return"".concat(y.toString().padStart(2,"0"),":").concat(j.toString().padStart(2,"0"),":").concat(g.toString().padStart(2,"0"),".").concat(m)}var r=n(85893);function mn(){var c=(0,d.useRef)(null),f=(0,d.useMemo)(function(){return on.Z.create()},[]),a=(0,d.useMemo)(function(){return un.Z.create(vn)},[]),y=(0,d.useMemo)(function(){return sn.Z.create(fn)},[]),j=(0,nn.o)(i()(i()({container:c},dn),{},{plugins:(0,d.useMemo)(function(){return[a,y,f]},[])}));return i()(i()({},j),{},{regions:f,containerRef:c})}var cn=function(){var f=mn(),a=f.wavesurfer,y=f.isPlaying,j=f.containerRef,g=f.regions,m=(0,d.useRef)({}),Sn=(0,d.useState)(null),M=p()(Sn,2),P=M[0],hn=M[1],pn=(0,d.useState)(null),O=p()(pn,2),Cn=O[0],yn=O[1];(0,d.useEffect)(function(){a&&(a.on("ready",function(){var u=a.getDuration();hn(g.addRegion({start:0,end:Math.min(10,Math.floor(u/4)),content:"Cut Region",drag:!0,resize:!0}))}),a.on("interaction",function(){a.play()}))},[a,g]);function jn(u){var s,e=u.target.files[0];if(e){g.clearRegions();var v=URL.createObjectURL(e);yn(v),a==null||(s=a.load)===null||s===void 0||s.call(a,v)}}var Rn=(0,d.useState)([]),L=p()(Rn,2),Tn=L[0],E=L[1],N=(0,_.useRequest)(Y()(x()().mark(function u(){var s,e,v,o,l,S,R;return x()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(P){t.next=2;break}return t.abrupt("return");case 2:if(s=P.start,e=P.end,v=W(s),o=W(e),!(!v||!o)){t.next=7;break}return t.abrupt("return");case 7:return l=new q.C,l.on("log",function(h){var I=h.message;return console.log(I)}),l.on("progress",function(h){var I=h.progress,Dn=h.time;return console.info("".concat(I*100," %, time: ").concat(Dn/1e6," s"))}),t.t0=l,t.next=13,(0,T.Wn)("".concat(F,"/ffmpeg-core.js"),"text/javascript");case 13:return t.t1=t.sent,t.next=16,(0,T.Wn)("".concat(F,"/ffmpeg-core.wasm"),"application/wasm");case 16:return t.t2=t.sent,t.t3={coreURL:t.t1,wasmURL:t.t2},t.next=20,t.t0.load.call(t.t0,t.t3);case 20:return t.t4=l,t.next=23,(0,T.dc)(Cn);case 23:return t.t5=t.sent,t.next=26,t.t4.writeFile.call(t.t4,"input.mp3",t.t5);case 26:return t.next=28,l.exec(["-i","input.mp3","-ss",v,"-to",o,"-acodec","copy","output.mp3"]);case 28:return t.next=30,l.readFile("output.mp3");case 30:S=t.sent,R=URL.createObjectURL(new Blob([S.buffer],{type:"audio/mpeg"})),E(function(h){return[].concat(Q()(h),[{url:R,start:s,end:e,startTime:v,endTime:o}])});case 33:case"end":return t.stop()}},u)})),{manual:!0}),Pn=N.loading,En=N.run,In=function(s,e,v){E(v)},Zn=(0,d.useState)(1),z=p()(Zn,2),H=z[0],An=z[1],xn=(0,d.useState)("RE.{{index}}.mp3"),B=p()(xn,2),V=B[0],Un=B[1];return(0,r.jsx)(k._z,{ghost:!0,children:(0,r.jsxs)(tn.Z,{spinning:Pn,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{ref:j}),(0,r.jsx)(U.Z,{style:{marginTop:24},type:"file",id:"uploader",accept:"audio/mpeg",onChange:jn})]}),(0,r.jsxs)(D.Z,{style:{marginTop:24,marginBottom:24},children:[(0,r.jsxs)(an.Z,{children:[(0,r.jsx)(C.ZP,{onClick:function(){return a==null?void 0:a.playPause()},children:y?"Pause":"Play"}),(0,r.jsx)(C.ZP,{onClick:En,children:"Cut"})]}),(0,r.jsx)(U.Z,{value:V,onChange:function(s){return Un(s.target.value)}}),(0,r.jsx)(en.Z,{min:1,value:H,onChange:function(s){return An(s)}})]}),(0,r.jsx)(w.Z,{rowKey:"url",search:!1,toolBarRender:!1,dataSource:Tn.map(function(u,s){return i()(i()({},u),{},{name:ln().compile(V)(i()(i()({},u),{},{index:s+H}))})}),columns:[{title:"\u6392\u5E8F",dataIndex:"sort",width:80},{title:"Start Time",dataIndex:"startTime"},{title:"End Time",dataIndex:"endTime"},{title:"Audio",dataIndex:"url",render:function(s,e){return(0,r.jsx)("audio",{src:e.url,controls:!0})}},{title:"File",dataIndex:"name"},{title:"Action",dataIndex:"action",render:function(s,e){return(0,r.jsxs)(D.Z,{children:[(0,r.jsx)(C.ZP,{onClick:function(){var o=document.createElement("a");o.href=e.url,o.download=e.name,document.body.appendChild(o),o.click(),document.body.removeChild(o)},children:"Download"}),(0,r.jsx)(C.ZP,{onClick:function(){var o;if((o=m.current)!==null&&o!==void 0&&o[e==null?void 0:e.url]){var l,S;(l=m.current)===null||l===void 0||(l=l[e==null?void 0:e.url])===null||l===void 0||(S=l.remove)===null||S===void 0||S.call(l),m.current=i()(i()({},m.current),{},A()({},e==null?void 0:e.url,void 0))}else{var R=g.addRegion({start:e.start,end:e.end,drag:!1,resize:!1,color:"rgba(9,105,218,0.2)"});m.current=i()(i()({},m.current),{},A()({},e==null?void 0:e.url,R))}},children:"Watch"}),(0,r.jsx)(C.ZP,{onClick:function(){E(function(o){return o.filter(function(l){return l.url!==e.url})})},children:"Delete"})]})}}],dragSortKey:"sort",onDragSortEnd:In})]})})},gn=cn}}]);
